<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pexip Health</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cklab-edges.ck-collab-engtest.com/static/webrtc/js/pexrtc.js"></script>
    <script src="webui.js"></script>
    <style>
        /* Add your CSS styles here */
        #vitals-container, #last-measurements-container {
            display: none; /* Initially hidden */
        }
        
        #iframe-container {
            width: 100%;
            height: 400px; /* Adjust as needed */
            overflow: hidden;
        }
    </style>
</head>
<body>
    <header>
        <h1>Conference Interface</h1>
    </header>

    <div id="vitals-container">
        <h2>Vitals Dashboard</h2>
        <img id="vitals-image" src="img/vitals.gif" alt="Vitals Dashboard">
    </div>

    <div id="last-measurements-container">
        <h2>Last Measurements</h2>
        <p>Last Weight: <span id="weight-last">N/A</span></p>
        <p>Last Height: <span id="height-last">N/A</span></p>
    </div>

    <div id="iframe-container"></div>

    <div id="selectrole" class="main site join">
        <h2>Select your role for this conference:</h2>
        <form>
            <div class="cf">
                <input type="radio" value="1" name="role" id="id_guest" checked>
                <label for="id_guest">Guest</label>
            </div>
            <div class="cf">
                <input type="radio" value="2" name="role" id="id_host">
                <label for="id_host">Host</label>
            </div>
            <button type="button" onclick="submitSelectRole()">Join Conference</button>
        </form>
    </div>

    <div id="pinentry" class="main site join">
        <form onsubmit="return submitPinEntry()">
            <label for="id_pin">Enter the conference PIN</label>
            <input type="password" name="pin" id="id_pin" placeholder="Enter the conference PIN" required>
            <button type="button" onclick="submitPinEntry()">Join Conference</button>
        </form>
    </div>

    <div id="maincontent" class="main">
        <section class="top">
            <aside class="participants">
                <h2 id="rosterheading">Participants</h2>
                <div id="rosterlist" class="roster"></div>
            </aside>

            <div class="video">
                <div class="videowrapper">
                    <video id="video" autoplay muted></video>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <p>&copy; 2024</p>
    </footer>

    <script>
        function initialise(server, alias, bandwidth, name, extra, source) {
            console.log('Initialising conference with:', { server, alias, bandwidth, name, extra, source });
            // Implement your initialisation logic here
        }

        function submitSelectRole() {
            var role = document.querySelector('input[name="role"]:checked').value;
            var alias = 'sampleAlias'; // Replace with actual alias
            var bandwidth = 'medium'; // Replace with actual bandwidth
            var name = 'Sample Name'; // Replace with actual name
            initialise('cklab-edges.ck-collab-engtest.com', alias, bandwidth, name, '', role);
            document.getElementById('video').style.display = 'block'; // Ensure video element is displayed
            checkVideoStream();
        }

        function submitPinEntry() {
            var pin = document.getElementById('id_pin').value;
            console.log('PIN entered:', pin);
            // Implement your PIN entry logic here
            checkVideoStream();
            return false; // Prevent form submission
        }

        function checkVideoStream() {
            var videoElement = document.getElementById('video');
            var interval = setInterval(function() {
                if (videoElement.srcObject && videoElement.srcObject.active) {
                    clearInterval(interval);
                    document.getElementById('vitals-container').style.display = 'block';
                    populateVitals();
                    document.getElementById('last-measurements-container').style.display = 'block';
                    populateLastMeasurements();
                    loadIframe();
                }
            }, 500); // Check every 500ms
        }

        function loadIframe() {
            var iframe = document.createElement('iframe');
            iframe.src = 'your_iframe_source.html'; // Replace with actual iframe source
            iframe.width = '100%';
            iframe.height = '400px'; // Adjust as needed
            iframe.style.border = 'none';
            document.getElementById('iframe-container').appendChild(iframe);
        }

        function populateVitals() {
            document.getElementById('vitals-image').src = 'img/vitals.gif';
        }

        function populateLastMeasurements() {
            // Populate last measurements here
            document.getElementById('weight-last').textContent = '70kg'; // Example value
            document.getElementById('height-last').textContent = '175cm'; // Example value
        }
    </script>
</body>
</html>
